From 933be171193c7037d48b990509185507b59b9f3c Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?=E7=A6=8F=E5=B3=B6=E8=A3=95=E6=A8=B9?=
 <hiroki.fukushima@MacBook-Air.local>
Date: Sat, 1 Nov 2025 19:39:05 +0900
Subject: [PATCH 2/3] =?UTF-8?q?=E3=83=87=E3=83=BC=E3=82=BF=E5=90=8C?=
 =?UTF-8?q?=E6=9C=9F=E5=95=8F=E9=A1=8C=E3=81=AE=E4=BF=AE=E6=AD=A3=E3=81=A8?=
 =?UTF-8?q?=E3=83=87=E3=83=90=E3=83=83=E3=82=B0=E6=A9=9F=E8=83=BD=E5=BC=B7?=
 =?UTF-8?q?=E5=8C=96?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

- è¦ªå­ç”»é¢ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±ä¸€ï¼ˆlocalStorage + API â†’ çµ±ä¸€APIï¼‰
- ãƒ¡ãƒ¢ãƒªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«æ°¸ç¶šåŒ–å®Ÿè£…
- è©³ç´°ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°è¿½åŠ 
- è¨˜äº‹åˆ¶é™ã®æ’¤å»ƒã¨æœ€æ–°é †ã‚½ãƒ¼ãƒˆå¯¾å¿œ

ğŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
---
 src/app/api/articles/archive/route.ts         |  47 +-
 src/app/api/articles/child/[childId]/route.ts |   3 +-
 src/app/api/articles/recent/route.ts          |  27 +-
 src/app/api/articles/share/route.ts           | 130 ++++--
 src/app/api/debug/database/route.ts           | 131 ++++++
 src/app/api/news/detail/route.ts              | 227 +++++++++
 src/app/api/news/list/route.ts                | 131 ++++++
 src/app/api/news/yahoo-detail/route.ts        | 433 ++++++++++++++++++
 src/lib/database/memory.ts                    |  89 +++-
 src/lib/database/supabase.ts                  |  19 +
 10 files changed, 1186 insertions(+), 51 deletions(-)
 create mode 100644 src/app/api/debug/database/route.ts
 create mode 100644 src/app/api/news/detail/route.ts
 create mode 100644 src/app/api/news/list/route.ts
 create mode 100644 src/app/api/news/yahoo-detail/route.ts

diff --git a/src/app/api/articles/archive/route.ts b/src/app/api/articles/archive/route.ts
index ecca568..889a9bd 100644
--- a/src/app/api/articles/archive/route.ts
+++ b/src/app/api/articles/archive/route.ts
@@ -1,5 +1,5 @@
 import { NextRequest, NextResponse } from 'next/server';
-import { archiveArticles, unarchiveArticles, getArchivedArticles } from '@/lib/article-store';
+import { getDatabase, DatabaseError } from '@/lib/database';
 
 // ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–è¨˜äº‹ã®å–å¾—
 export async function GET(request: NextRequest) {
@@ -9,7 +9,11 @@ export async function GET(request: NextRequest) {
     
     console.log(`ğŸ“¦ ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–è¨˜äº‹ã‚’å–å¾—ä¸­... (limit: ${limit})`);
     
-    const archivedArticles = getArchivedArticles(limit);
+    const db = getDatabase();
+    const archivedArticles = await db.getArticles({
+      isArchived: true,
+      limit
+    });
     
     console.log(`âœ… ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–è¨˜äº‹å–å¾—å®Œäº†: ${archivedArticles.length}ä»¶`);
     
@@ -48,27 +52,50 @@ export async function POST(request: NextRequest) {
       );
     }
     
-    let result;
+    const db = getDatabase();
+    let successCount = 0;
+    const errors: string[] = [];
+    
     if (action === 'archive') {
       console.log(`ğŸ“¦ è¨˜äº‹ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–åŒ–å®Ÿè¡Œ: ${articleIds.join(', ')}`);
-      result = archiveArticles(articleIds);
+      for (const id of articleIds) {
+        try {
+          const result = await db.updateArticle(id, { 
+            isArchived: true, 
+            archivedAt: new Date().toISOString() 
+          });
+          if (result) successCount++;
+        } catch (error) {
+          errors.push(`è¨˜äº‹ID ${id}: ${error instanceof Error ? error.message : 'Unknown error'}`);
+        }
+      }
     } else {
       console.log(`ğŸ“¤ è¨˜äº‹ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–è§£é™¤å®Ÿè¡Œ: ${articleIds.join(', ')}`);
-      result = unarchiveArticles(articleIds);
+      for (const id of articleIds) {
+        try {
+          const result = await db.updateArticle(id, { 
+            isArchived: false, 
+            archivedAt: undefined 
+          });
+          if (result) successCount++;
+        } catch (error) {
+          errors.push(`è¨˜äº‹ID ${id}: ${error instanceof Error ? error.message : 'Unknown error'}`);
+        }
+      }
     }
     
-    if (result.success) {
+    if (errors.length === 0) {
       return NextResponse.json({
         success: true,
-        message: `${result.count}ä»¶ã®è¨˜äº‹ã‚’${action === 'archive' ? 'ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–' : 'ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–è§£é™¤'}ã—ã¾ã—ãŸ`,
-        count: result.count
+        message: `${successCount}ä»¶ã®è¨˜äº‹ã‚’${action === 'archive' ? 'ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–' : 'ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–è§£é™¤'}ã—ã¾ã—ãŸ`,
+        count: successCount
       });
     } else {
       return NextResponse.json({
         success: false,
         message: `ä¸€éƒ¨ã®è¨˜äº‹ã§å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸ`,
-        count: result.count,
-        errors: result.errors
+        count: successCount,
+        errors: errors
       }, { status: 207 }); // 207 Multi-Status
     }
     
diff --git a/src/app/api/articles/child/[childId]/route.ts b/src/app/api/articles/child/[childId]/route.ts
index 602fe05..714eaea 100644
--- a/src/app/api/articles/child/[childId]/route.ts
+++ b/src/app/api/articles/child/[childId]/route.ts
@@ -18,7 +18,8 @@ export async function GET(
     // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰å¹´é½¢ã‚„ã‚«ãƒ†ã‚´ãƒªã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
     const { searchParams } = new URL(request.url);
     const category = searchParams.get('category');
-    const limit = parseInt(searchParams.get('limit') || '10');
+    const limitParam = searchParams.get('limit');
+    const limit = limitParam ? parseInt(limitParam) : 1000; // limitãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯å¤§ããªå€¤ï¼ˆå®Ÿè³ªåˆ¶é™ãªã—ï¼‰
     
     console.log(`ğŸ“š å­ä¾›ID ${childId} ã®è¨˜äº‹ã‚’å–å¾—ä¸­...`, { category, limit });
     
diff --git a/src/app/api/articles/recent/route.ts b/src/app/api/articles/recent/route.ts
index e8cfef6..006937c 100644
--- a/src/app/api/articles/recent/route.ts
+++ b/src/app/api/articles/recent/route.ts
@@ -1,19 +1,24 @@
 import { NextRequest, NextResponse } from 'next/server';
-import { getRecentArticles, getStats } from '@/lib/article-store';
+import { getDatabase, DatabaseError } from '@/lib/database';
 
 export async function GET(request: NextRequest) {
   try {
     const { searchParams } = new URL(request.url);
-    const limit = parseInt(searchParams.get('limit') || '5');
+    const limitParam = searchParams.get('limit');
+    const limit = limitParam ? parseInt(limitParam) : 1000; // limitãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯å¤§ããªå€¤ï¼ˆå®Ÿè³ªåˆ¶é™ãªã—ï¼‰
     const includeArchived = searchParams.get('includeArchived') === 'true';
     
     console.log(`ğŸ“Š æœ€è¿‘ã®è¨˜äº‹ã‚’å–å¾—ä¸­... (limit: ${limit}, includeArchived: ${includeArchived})`);
     
-    // æœ€è¿‘ã®è¨˜äº‹ã‚’å–å¾—
-    const articles = getRecentArticles(limit, includeArchived);
+    // æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æŠ½è±¡åŒ–å±¤ã‹ã‚‰è¨˜äº‹ã‚’å–å¾—
+    const db = getDatabase();
+    const articles = await db.getArticles({
+      isArchived: includeArchived ? undefined : false, // includeArchived=falseã®å ´åˆã®ã¿ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã•ã‚Œã¦ã„ãªã„è¨˜äº‹ã‚’å–å¾—
+      limit
+    });
     
     // çµ±è¨ˆæƒ…å ±ã‚‚å–å¾—
-    const stats = getStats('child1'); // ç¾åœ¨ã¯å›ºå®šã€å®Ÿéš›ã¯å‹•çš„ã«å–å¾—
+    const stats = await db.getStats('child1'); // ç¾åœ¨ã¯å›ºå®šã€å®Ÿéš›ã¯å‹•çš„ã«å–å¾—
     
     console.log(`âœ… å–å¾—å®Œäº†: ${articles.length}ä»¶ã®è¨˜äº‹`);
     
@@ -26,6 +31,18 @@ export async function GET(request: NextRequest) {
     
   } catch (error) {
     console.error('âŒ æœ€è¿‘ã®è¨˜äº‹å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
+    
+    // DatabaseErrorã®ç‰¹åˆ¥å‡¦ç†
+    if (error instanceof DatabaseError) {
+      return NextResponse.json(
+        { 
+          error: `ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼: ${error.message}`,
+          code: error.code
+        },
+        { status: 500 }
+      );
+    }
+    
     return NextResponse.json(
       { error: `è¨˜äº‹ã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error instanceof Error ? error.message : 'Unknown error'}` },
       { status: 500 }
diff --git a/src/app/api/articles/share/route.ts b/src/app/api/articles/share/route.ts
index 167b2c2..b61620a 100644
--- a/src/app/api/articles/share/route.ts
+++ b/src/app/api/articles/share/route.ts
@@ -38,10 +38,53 @@ export async function POST(request: NextRequest) {
       );
     }
     
-    // 1. è¨˜äº‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
+    // 1. è¨˜äº‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾— - Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®å ´åˆã¯å°‚ç”¨APIã‚’ä½¿ç”¨
     console.log('ğŸ“° è¨˜äº‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ä¸­...', url);
-    const rawArticleData = await fetchArticleMetadata(url);
-    const articleContent = convertToArticleContent(rawArticleData);
+    
+    let rawArticleData;
+    let articleContent;
+    
+    if (url.includes('news.yahoo.co.jp')) {
+      console.log('ğŸ”„ Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹å°‚ç”¨ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä½¿ç”¨...');
+      
+      // Yahoo!è¨˜äº‹è©³ç´°å–å¾—APIã‚’å†…éƒ¨çš„ã«å‘¼ã³å‡ºã—
+      const baseUrl = process.env.VERCEL_URL 
+        ? `https://${process.env.VERCEL_URL}` 
+        : process.env.NEXTAUTH_URL || 'http://localhost:3000';
+      
+      console.log(`ğŸ”— å†…éƒ¨APIå‘¼ã³å‡ºã—: ${baseUrl}/api/news/yahoo-detail`);
+      
+      const yahooResponse = await fetch(`${baseUrl}/api/news/yahoo-detail?url=${encodeURIComponent(url)}`, {
+        headers: {
+          'User-Agent': 'Mozilla/5.0 (compatible; InternalAPICall/1.0)',
+        }
+      });
+      
+      if (!yahooResponse.ok) {
+        throw new Error(`Yahoo!APIå‘¼ã³å‡ºã—ã‚¨ãƒ©ãƒ¼: ${yahooResponse.status} ${yahooResponse.statusText}`);
+      }
+      
+      const yahooResult = await yahooResponse.json();
+      
+      if (yahooResult.success) {
+        const yahooArticle = yahooResult.article;
+        rawArticleData = {
+          title: yahooArticle.title,
+          description: yahooArticle.summary,
+          content: yahooArticle.content,
+          image: yahooArticle.image,
+          url: yahooArticle.url,
+          site_name: yahooArticle.source
+        };
+        articleContent = convertToArticleContent(rawArticleData);
+      } else {
+        throw new Error(`Yahoo!è¨˜äº‹å–å¾—ã‚¨ãƒ©ãƒ¼: ${yahooResult.error}`);
+      }
+    } else {
+      // é€šå¸¸ã®è¨˜äº‹å–å¾—
+      rawArticleData = await fetchArticleMetadata(url);
+      articleContent = convertToArticleContent(rawArticleData);
+    }
     
     console.log('âœ… è¨˜äº‹ãƒ‡ãƒ¼ã‚¿å–å¾—å®Œäº†:', {
       title: articleContent.title.substring(0, 50),
@@ -60,37 +103,72 @@ export async function POST(request: NextRequest) {
     });
     
     // 3. æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æŠ½è±¡åŒ–å±¤ã«ä¿å­˜
-    const db = getDatabase();
-    const articleData = {
-      originalUrl: url,
-      childAge,
-      originalTitle: articleContent.title,
-      convertedTitle: convertedArticle.title,
-      originalContent: articleContent.content,
-      convertedContent: convertedArticle.content,
-      convertedSummary: convertedArticle.summary,
-      category: convertedArticle.category,
-      status: 'completed',
-      siteName: rawArticleData.site_name,
-      image: rawArticleData.image,
-      hasRead: false,
-      reactions: [],
-      isArchived: false
-    };
-    
-    const savedArticle = await db.createArticle(articleData);
-    
-    console.log('ğŸ‰ è¨˜äº‹ã®å¤‰æ›ãŒå®Œäº†ã—ã¾ã—ãŸ:', savedArticle.id);
+    let savedArticle;
+    
+    try {
+      console.log('ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ä¸­...');
+      const db = getDatabase();
+      const articleData = {
+        originalUrl: url,
+        childAge,
+        originalTitle: articleContent.title,
+        convertedTitle: convertedArticle.title,
+        originalContent: articleContent.content,
+        convertedContent: convertedArticle.content,
+        convertedSummary: convertedArticle.summary,
+        category: convertedArticle.category,
+        status: 'completed',
+        siteName: rawArticleData.site_name,
+        image: rawArticleData.image,
+        hasRead: false,
+        reactions: [],
+        isArchived: false
+      };
+      
+      savedArticle = await db.createArticle(articleData);
+      console.log('âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜å®Œäº†:', savedArticle.id);
+      
+    } catch (dbError) {
+      console.warn('âš ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜å¤±æ•—ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã¿ã§å¯¾å¿œ:', dbError);
+      
+      // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜å¤±æ•—æ™‚ã¯ã€å¤‰æ›çµæœã ã‘ã§ã‚‚è¿”ã™
+      savedArticle = {
+        id: Date.now(), // ä¸€æ™‚çš„ãªID
+        originalUrl: url,
+        childAge,
+        originalTitle: articleContent.title,
+        convertedTitle: convertedArticle.title,
+        originalContent: articleContent.content,
+        convertedContent: convertedArticle.content,
+        convertedSummary: convertedArticle.summary,
+        category: convertedArticle.category,
+        status: 'completed',
+        siteName: rawArticleData.site_name,
+        image: rawArticleData.image,
+        hasRead: false,
+        reactions: [],
+        isArchived: false,
+        createdAt: new Date().toISOString(),
+        updatedAt: new Date().toISOString()
+      };
+    }
+    
+    const message = savedArticle.id > 1000000000000 // ä¸€æ™‚çš„IDã®å ´åˆ
+      ? 'AIå¤‰æ›ãŒå®Œäº†ã—ã¾ã—ãŸï¼ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã•ã‚Œã¾ã—ãŸã€‚'
+      : 'AIå¤‰æ›ãŒå®Œäº†ã—ã¾ã—ãŸï¼å­ä¾›ãŒãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ã§èª­ã‚ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚';
+    
+    console.log('ğŸ‰ è¨˜äº‹ã®å¤‰æ›ãŒå®Œäº†ã—ã¾ã—ãŸ:', message);
     
     return NextResponse.json({
       success: true,
       article: savedArticle,
-      message: 'AIå¤‰æ›ãŒå®Œäº†ã—ã¾ã—ãŸï¼å­ä¾›ãŒãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ã§èª­ã‚ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚',
+      message,
       metadata: {
         processingTime: Date.now(),
         originalLength: articleContent.content.length,
         convertedLength: convertedArticle.content.length,
-        compressionRatio: Math.round((convertedArticle.content.length / articleContent.content.length) * 100)
+        compressionRatio: Math.round((convertedArticle.content.length / articleContent.content.length) * 100),
+        databaseSaved: savedArticle.id <= 1000000000000
       }
     });
     
diff --git a/src/app/api/debug/database/route.ts b/src/app/api/debug/database/route.ts
new file mode 100644
index 0000000..57f763d
--- /dev/null
+++ b/src/app/api/debug/database/route.ts
@@ -0,0 +1,131 @@
+import { NextRequest, NextResponse } from 'next/server';
+import { getDatabase, checkDatabaseHealth } from '@/lib/database';
+
+export async function GET(request: NextRequest) {
+  try {
+    console.log('ğŸ” ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨ºæ–­é–‹å§‹...');
+    
+    // ç’°å¢ƒå¤‰æ•°ãƒã‚§ãƒƒã‚¯
+    const envStatus = {
+      USE_DATABASE: process.env.NEXT_PUBLIC_USE_DATABASE || 'false',
+      SUPABASE_URL_SET: !!process.env.NEXT_PUBLIC_SUPABASE_URL,
+      SUPABASE_KEY_SET: !!process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,
+      OPENAI_KEY_SET: !!process.env.OPENAI_API_KEY,
+      SUPABASE_URL: process.env.NEXT_PUBLIC_SUPABASE_URL ? 'SET' : 'MISSING',
+      SUPABASE_ANON_KEY: process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY ? 'SET' : 'MISSING'
+    };
+    
+    console.log('ğŸ“Š ç’°å¢ƒå¤‰æ•°çŠ¶æ³:', envStatus);
+    
+    // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å–å¾—
+    const db = getDatabase();
+    console.log('âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å–å¾—å®Œäº†');
+    
+    // ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
+    console.log('ğŸ”„ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œä¸­...');
+    const healthStatus = await checkDatabaseHealth();
+    console.log('ğŸ“‹ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯çµæœ:', healthStatus);
+    
+    // æ¥ç¶šãƒ†ã‚¹ãƒˆ
+    let connectionTest = null;
+    try {
+      console.log('ğŸ”— ç›´æ¥æ¥ç¶šãƒ†ã‚¹ãƒˆä¸­...');
+      const testResult = await db.testConnection();
+      connectionTest = { success: testResult };
+      console.log('âœ… ç›´æ¥æ¥ç¶šãƒ†ã‚¹ãƒˆçµæœ:', testResult);
+    } catch (error) {
+      connectionTest = { 
+        success: false, 
+        error: error instanceof Error ? error.message : 'Unknown error' 
+      };
+      console.error('âŒ ç›´æ¥æ¥ç¶šãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
+    }
+    
+    // çµ±è¨ˆæƒ…å ±ã®å–å¾—
+    let stats = null;
+    try {
+      console.log('ğŸ“Š çµ±è¨ˆæƒ…å ±å–å¾—ä¸­...');
+      stats = await db.getStats();
+      console.log('âœ… çµ±è¨ˆæƒ…å ±å–å¾—å®Œäº†:', stats);
+    } catch (error) {
+      console.error('âŒ çµ±è¨ˆæƒ…å ±å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
+      stats = { error: error instanceof Error ? error.message : 'Unknown error' };
+    }
+    
+    // è¨˜äº‹å–å¾—ãƒ†ã‚¹ãƒˆ
+    let articlesTest = null;
+    try {
+      console.log('ğŸ“š è¨˜äº‹å–å¾—ãƒ†ã‚¹ãƒˆä¸­...');
+      const articles = await db.getArticles({ limit: 5 });
+      articlesTest = { 
+        success: true, 
+        count: articles.length,
+        articles: articles.map(article => ({
+          id: article.id,
+          title: article.convertedTitle.substring(0, 50),
+          category: article.category,
+          hasRead: article.hasRead,
+          isArchived: article.isArchived,
+          reactions: article.reactions,
+          createdAt: article.createdAt
+        }))
+      };
+      console.log('âœ… è¨˜äº‹å–å¾—ãƒ†ã‚¹ãƒˆçµæœ:', articlesTest);
+    } catch (error) {
+      articlesTest = { 
+        success: false, 
+        error: error instanceof Error ? error.message : 'Unknown error' 
+      };
+      console.error('âŒ è¨˜äº‹å–å¾—ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
+    }
+    
+    const diagnostics = {
+      timestamp: new Date().toISOString(),
+      environment: envStatus,
+      health: healthStatus,
+      connectionTest,
+      stats,
+      articlesTest,
+      recommendations: []
+    };
+    
+    // æ¨å¥¨äº‹é …ç”Ÿæˆ
+    if (!healthStatus.healthy) {
+      diagnostics.recommendations.push('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãŒå¤±æ•—ã—ã¦ã„ã¾ã™ã€‚ç’°å¢ƒå¤‰æ•°ã¨Supabaseã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
+    }
+    
+    if (envStatus.USE_DATABASE === 'true' && (!envStatus.SUPABASE_URL_SET || !envStatus.SUPABASE_KEY_SET)) {
+      diagnostics.recommendations.push('Supabaseã®ç’°å¢ƒå¤‰æ•°ãŒä¸å®Œå…¨ã§ã™ã€‚NEXT_PUBLIC_SUPABASE_URLã¨NEXT_PUBLIC_SUPABASE_ANON_KEYã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚');
+    }
+    
+    if (connectionTest?.success === false) {
+      diagnostics.recommendations.push('Supabaseã¨ã®æ¥ç¶šã«å¤±æ•—ã—ã¦ã„ã¾ã™ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã¨Supabaseã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
+    }
+    
+    if (articlesTest?.success === false) {
+      diagnostics.recommendations.push('è¨˜äº‹ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„ã‹ã€ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚Supabaseã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚');
+    }
+    
+    if (articlesTest?.success === true && articlesTest.count === 0) {
+      diagnostics.recommendations.push('è¨˜äº‹ãƒ†ãƒ¼ãƒ–ãƒ«ã¯å­˜åœ¨ã—ã¾ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚è¨˜äº‹å¤‰æ›ã‚’å®Ÿè¡Œã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚');
+    }
+    
+    console.log('ğŸ¯ è¨ºæ–­å®Œäº†:', diagnostics);
+    
+    return NextResponse.json({
+      success: true,
+      diagnostics,
+      message: `ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨ºæ–­å®Œäº† (ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼: ${healthStatus.provider})`
+    });
+    
+  } catch (error) {
+    console.error('âŒ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨ºæ–­ã‚¨ãƒ©ãƒ¼:', error);
+    
+    return NextResponse.json({
+      success: false,
+      error: error instanceof Error ? error.message : 'Unknown error',
+      stack: error instanceof Error ? error.stack : undefined,
+      timestamp: new Date().toISOString()
+    }, { status: 500 });
+  }
+}
\ No newline at end of file
diff --git a/src/app/api/news/detail/route.ts b/src/app/api/news/detail/route.ts
new file mode 100644
index 0000000..669167d
--- /dev/null
+++ b/src/app/api/news/detail/route.ts
@@ -0,0 +1,227 @@
+import { NextRequest, NextResponse } from 'next/server';
+import { JSDOM } from 'jsdom';
+
+export interface ArticleDetail {
+  title: string;
+  content: string;
+  publishedAt: string;
+  image?: string;
+  summary: string;
+  url: string;
+}
+
+async function scrapeNHKArticle(url: string): Promise<ArticleDetail> {
+  try {
+    console.log(`ğŸ”„ NHKè¨˜äº‹ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°é–‹å§‹: ${url}`);
+    
+    // ãƒ•ã‚§ãƒƒãƒ
+    const response = await fetch(url, {
+      headers: {
+        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
+      }
+    });
+    
+    if (!response.ok) {
+      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
+    }
+    
+    const html = await response.text();
+    const dom = new JSDOM(html);
+    const document = dom.window.document;
+    
+    // ãƒ‡ãƒãƒƒã‚°ï¼šãƒšãƒ¼ã‚¸ã®ä¸»è¦ãªæ§‹é€ ã‚’ç¢ºèª
+    console.log('ğŸ” ãƒšãƒ¼ã‚¸æ§‹é€ ãƒ‡ãƒãƒƒã‚°:');
+    const mainElements = [
+      'article',
+      '.article-main', 
+      '.content-main',
+      '.module--detail-content',
+      '.detail-content',
+      'main',
+      '.content-body',
+      '.article-body'
+    ];
+    
+    mainElements.forEach(selector => {
+      const element = document.querySelector(selector);
+      if (element) {
+        console.log(`  âœ… ç™ºè¦‹: ${selector}`);
+        // å­è¦ç´ ã‚‚ç¢ºèª
+        const children = element.children;
+        console.log(`    å­è¦ç´ : ${children.length}å€‹`);
+        for (let i = 0; i < Math.min(children.length, 5); i++) {
+          console.log(`      - ${children[i].tagName}.${children[i].className}`);
+        }
+      }
+    });
+    
+    // ã‚¿ã‚¤ãƒˆãƒ«å–å¾—
+    const titleElement = document.querySelector('h1.content-title') || 
+                        document.querySelector('h1.article-title') ||
+                        document.querySelector('h1') ||
+                        document.querySelector('.article-header h1') ||
+                        document.querySelector('title');
+    const title = titleElement?.textContent?.trim() || 'ã‚¿ã‚¤ãƒˆãƒ«ä¸æ˜';
+    
+    // æœ¬æ–‡å–å¾— - NHKã®æ–°ã—ã„æ§‹é€ ã«å¯¾å¿œ
+    const contentSelectors = [
+      'article div[class*="esl7kn2s"] p',  // NHKã®æ–°æ§‹é€ ã«å¯¾å¿œ
+      'article div p',                     // ã‚ˆã‚Šåºƒç¯„å›²
+      '[class*="content"] p',              // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç³»ã‚¯ãƒ©ã‚¹
+      '[class*="body"] p',                 // ãƒœãƒ‡ã‚£ç³»ã‚¯ãƒ©ã‚¹
+      '[class*="text"] p',                 // ãƒ†ã‚­ã‚¹ãƒˆç³»ã‚¯ãƒ©ã‚¹
+      '.content-body .body-text p',        // å¾“æ¥æ§‹é€ 
+      '.article-body .body-text p',
+      '.body-text p',
+      'main p',                            // ã‚ˆã‚Šåºƒç¯„å›²
+      'article p'                          // æœ€ã‚‚åºƒç¯„å›²
+    ];
+    
+    let contentElements: NodeListOf<Element> | null = null;
+    let selectedSelector = '';
+    
+    for (const selector of contentSelectors) {
+      contentElements = document.querySelectorAll(selector);
+      if (contentElements.length > 0) {
+        selectedSelector = selector;
+        console.log(`âœ… ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å–å¾—æˆåŠŸ: ${selector} - ${contentElements.length}å€‹ã®æ®µè½`);
+        break;
+      }
+    }
+    
+    let content = '';
+    if (contentElements && contentElements.length > 0) {
+      const contentParts: string[] = [];
+      contentElements.forEach((element, index) => {
+        const text = element.textContent?.trim();
+        if (text && 
+            text.length > 30 &&                    // ã‚ˆã‚Šé•·ã„æ–‡ç« ã®ã¿ï¼ˆè¨˜äº‹æœ¬æ–‡ã‚‰ã—ãï¼‰
+            !text.includes('ã‚·ã‚§ã‚¢') && 
+            !text.includes('ãƒ„ã‚¤ãƒ¼ãƒˆ') &&
+            !text.includes('é–¢é€£è¨˜äº‹') &&
+            !text.includes('ç¶šãã‚’èª­ã‚€') &&
+            !text.includes('JavaScript') &&       // JSã‚³ãƒ¼ãƒ‰é™¤å¤–
+            !text.includes('const ') &&           // JSã‚³ãƒ¼ãƒ‰é™¤å¤–
+            !text.includes('function') &&         // JSã‚³ãƒ¼ãƒ‰é™¤å¤–
+            !text.includes('document.') &&        // JSã‚³ãƒ¼ãƒ‰é™¤å¤–
+            !text.includes('window.') &&          // JSã‚³ãƒ¼ãƒ‰é™¤å¤–
+            !text.includes('mediaQuery') &&       // JSã‚³ãƒ¼ãƒ‰é™¤å¤–
+            !text.includes('classList') &&        // JSã‚³ãƒ¼ãƒ‰é™¤å¤–
+            !text.includes('addEventListener') &&  // JSã‚³ãƒ¼ãƒ‰é™¤å¤–
+            !text.match(/^\d+æœˆ\d+æ—¥/) &&
+            !text.match(/^[ã€Œã€].*[ã€ã€‘]$/) &&     // ã‚¿ã‚¤ãƒˆãƒ«å½¢å¼ã‚’é™¤å¤–
+            text.includes('ã€‚') &&                 // æ—¥æœ¬èªã®æ–‡ç« ã‚‰ã—ã•
+            !text.match(/^[a-zA-Z\s\.\(\)]+$/)) {  // è‹±èªã®ã¿ã®è¡Œã‚’é™¤å¤–
+          contentParts.push(text);
+          if (index < 5) {
+            console.log(`ğŸ“ æ®µè½${index + 1}: ${text.substring(0, 50)}...`);
+          }
+        }
+      });
+      content = contentParts.join('\n\n');
+      console.log(`ğŸ“„ æœ€çµ‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é•·: ${content.length}æ–‡å­—, æ®µè½æ•°: ${contentParts.length}`);
+    }
+    
+    // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå–å¾—ã§ããªã„å ´åˆã¯ã€ã‚ˆã‚Šåºƒç¯„å›²ã§å–å¾—
+    if (!content || content.length < 50) {
+      console.log('âš ï¸ è©³ç´°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å–å¾—å¤±æ•—ã€ä»£æ›¿æ–¹æ³•ã‚’è©¦è¡Œ');
+      const bodyText = document.body?.textContent || '';
+      const lines = bodyText.split('\n')
+        .map(line => line.trim())
+        .filter(line => line.length > 20 && 
+          !line.includes('ã‚·ã‚§ã‚¢') && 
+          !line.includes('ãƒ„ã‚¤ãƒ¼ãƒˆ') &&
+          !line.includes('JavaScript') &&
+          !line.includes('cookie'))
+        .slice(0, 10); // æœ€åˆã®10è¡Œç¨‹åº¦
+      content = lines.join('\n\n');
+    }
+    
+    // ç”»åƒå–å¾—
+    const imageElement = document.querySelector('img[src*="nhk.or.jp"]') ||
+                        document.querySelector('.article-main img') ||
+                        document.querySelector('.content-main img') ||
+                        document.querySelector('article img');
+    let image = imageElement?.getAttribute('src') || '';
+    if (image && !image.startsWith('http')) {
+      image = `https://www3.nhk.or.jp${image}`;
+    }
+    
+    // å…¬é–‹æ—¥æ™‚å–å¾—
+    const timeElement = document.querySelector('time') ||
+                       document.querySelector('.date') ||
+                       document.querySelector('.published');
+    const publishedAt = timeElement?.getAttribute('datetime') || 
+                       timeElement?.textContent?.trim() || 
+                       new Date().toISOString();
+    
+    // è¦ç´„ä½œæˆï¼ˆæœ€åˆã®æ®µè½ã¾ãŸã¯150æ–‡å­—ï¼‰
+    const summary = content.length > 150 
+      ? content.substring(0, 150) + '...'
+      : content;
+    
+    const result: ArticleDetail = {
+      title,
+      content: content || 'è¨˜äº‹å†…å®¹ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚',
+      publishedAt,
+      image: image || undefined,
+      summary,
+      url
+    };
+    
+    console.log(`âœ… NHKè¨˜äº‹ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°å®Œäº†:`, {
+      title: title.substring(0, 30) + '...',
+      contentLength: content.length,
+      hasImage: !!image
+    });
+    
+    return result;
+    
+  } catch (error) {
+    console.error(`âŒ NHKè¨˜äº‹ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚¨ãƒ©ãƒ¼: ${url}`, error);
+    throw error;
+  }
+}
+
+export async function GET(request: NextRequest) {
+  try {
+    const { searchParams } = new URL(request.url);
+    const url = searchParams.get('url');
+    
+    if (!url) {
+      return NextResponse.json({
+        success: false,
+        error: 'URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå¿…è¦ã§ã™'
+      }, { status: 400 });
+    }
+    
+    // NHKã®URLã‹ãƒã‚§ãƒƒã‚¯
+    if (!url.includes('nhk.or.jp')) {
+      return NextResponse.json({
+        success: false,
+        error: 'NHKã®è¨˜äº‹URLã®ã¿ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™'
+      }, { status: 400 });
+    }
+    
+    console.log(`ğŸ”„ è¨˜äº‹è©³ç´°å–å¾—é–‹å§‹: ${url}`);
+    
+    const articleDetail = await scrapeNHKArticle(url);
+    
+    console.log(`âœ… è¨˜äº‹è©³ç´°å–å¾—å®Œäº†`);
+    
+    return NextResponse.json({
+      success: true,
+      article: articleDetail,
+      fetchedAt: new Date().toISOString()
+    });
+    
+  } catch (error) {
+    console.error('è¨˜äº‹è©³ç´°å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
+    
+    return NextResponse.json({
+      success: false,
+      error: 'è¨˜äº‹ã®è©³ç´°å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ',
+      details: error instanceof Error ? error.message : 'Unknown error'
+    }, { status: 500 });
+  }
+}
\ No newline at end of file
diff --git a/src/app/api/news/list/route.ts b/src/app/api/news/list/route.ts
new file mode 100644
index 0000000..1edcdea
--- /dev/null
+++ b/src/app/api/news/list/route.ts
@@ -0,0 +1,131 @@
+import { NextRequest, NextResponse } from 'next/server';
+import Parser from 'rss-parser';
+import { JSDOM } from 'jsdom';
+
+
+const parser = new Parser({
+  customFields: {
+    item: [
+      ['media:thumbnail', 'thumbnail'],
+      ['media:content', 'mediaContent'],
+    ]
+  }
+});
+
+export interface NewsItem {
+  title: string;
+  link: string;
+  description: string;
+  pubDate: string;
+  category: string;
+  thumbnail?: string;
+}
+
+// Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®RSSãƒ•ã‚£ãƒ¼ãƒ‰ä¸€è¦§
+const YAHOO_RSS_FEEDS = {
+  main: 'https://news.yahoo.co.jp/rss/topics/top-picks.xml',     // ä¸»è¦
+  domestic: 'https://news.yahoo.co.jp/rss/topics/domestic.xml', // å›½å†…
+  world: 'https://news.yahoo.co.jp/rss/topics/world.xml',       // å›½éš›
+  business: 'https://news.yahoo.co.jp/rss/topics/business.xml', // çµŒæ¸ˆ
+  entertainment: 'https://news.yahoo.co.jp/rss/topics/entertainment.xml', // ã‚¨ãƒ³ã‚¿ãƒ¡
+  sports: 'https://news.yahoo.co.jp/rss/topics/sports.xml',     // ã‚¹ãƒãƒ¼ãƒ„
+  it: 'https://news.yahoo.co.jp/rss/topics/it.xml',             // IT
+  science: 'https://news.yahoo.co.jp/rss/topics/science.xml',   // ç§‘å­¦
+};
+
+async function fetchRSSFeed(url: string, categoryName: string): Promise<NewsItem[]> {
+  try {
+    console.log(`ğŸ“¡ RSSå–å¾—é–‹å§‹: ${categoryName} - ${url}`);
+    
+    const feed = await parser.parseURL(url);
+    
+    const items: NewsItem[] = feed.items.map((item) => ({
+      title: item.title || '',
+      link: item.link || '',
+      description: item.contentSnippet || item.description || '',
+      pubDate: item.pubDate || new Date().toISOString(),
+      category: categoryName,
+      thumbnail: (item as any).thumbnail?.url || (item as any)['media:thumbnail']?.url
+    }));
+    
+    console.log(`âœ… RSSå–å¾—å®Œäº†: ${categoryName} - ${items.length}ä»¶`);
+    return items;
+  } catch (error) {
+    console.error(`âŒ RSSå–å¾—ã‚¨ãƒ©ãƒ¼: ${categoryName}`, error);
+    return [];
+  }
+}
+
+export async function GET(request: NextRequest) {
+  try {
+    const { searchParams } = new URL(request.url);
+    const category = searchParams.get('category') || 'main';
+    const limit = parseInt(searchParams.get('limit') || '20');
+    
+    console.log(`ğŸ”„ ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§å–å¾—é–‹å§‹ - ã‚«ãƒ†ã‚´ãƒª: ${category}, åˆ¶é™: ${limit}`);
+    
+    let newsItems: NewsItem[] = [];
+    
+    if (category === 'all') {
+      // å…¨ã‚«ãƒ†ã‚´ãƒªã‹ã‚‰å–å¾—
+      const promises = Object.entries(YAHOO_RSS_FEEDS).map(([key, url]) => 
+        fetchRSSFeed(url, getCategoryDisplayName(key))
+      );
+      
+      const results = await Promise.allSettled(promises);
+      newsItems = results
+        .filter((result): result is PromiseFulfilledResult<NewsItem[]> => result.status === 'fulfilled')
+        .flatMap(result => result.value);
+        
+    } else if (YAHOO_RSS_FEEDS[category as keyof typeof YAHOO_RSS_FEEDS]) {
+      // æŒ‡å®šã‚«ãƒ†ã‚´ãƒªã‹ã‚‰å–å¾—
+      const url = YAHOO_RSS_FEEDS[category as keyof typeof YAHOO_RSS_FEEDS];
+      newsItems = await fetchRSSFeed(url, getCategoryDisplayName(category));
+    } else {
+      return NextResponse.json({
+        success: false,
+        error: 'ç„¡åŠ¹ãªã‚«ãƒ†ã‚´ãƒªã§ã™'
+      }, { status: 400 });
+    }
+    
+    // å…¬é–‹æ—¥æ™‚é †ã§ã‚½ãƒ¼ãƒˆ
+    newsItems.sort((a, b) => new Date(b.pubDate).getTime() - new Date(a.pubDate).getTime());
+    
+    // åˆ¶é™æ•°ã«çµã‚‹
+    const limitedItems = newsItems.slice(0, limit);
+    
+    console.log(`âœ… ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§å–å¾—å®Œäº† - ${limitedItems.length}ä»¶è¿”å´`);
+    
+    return NextResponse.json({
+      success: true,
+      news: limitedItems,
+      totalCount: limitedItems.length,
+      category: category,
+      fetchedAt: new Date().toISOString()
+    });
+    
+  } catch (error) {
+    console.error('ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
+    
+    return NextResponse.json({
+      success: false,
+      error: 'ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ',
+      details: error instanceof Error ? error.message : 'Unknown error'
+    }, { status: 500 });
+  }
+}
+
+function getCategoryDisplayName(key: string): string {
+  const categoryMap: { [key: string]: string } = {
+    main: 'ä¸»è¦',
+    domestic: 'å›½å†…',
+    world: 'å›½éš›',
+    business: 'çµŒæ¸ˆ',
+    entertainment: 'ã‚¨ãƒ³ã‚¿ãƒ¡',
+    sports: 'ã‚¹ãƒãƒ¼ãƒ„',
+    it: 'IT',
+    science: 'ç§‘å­¦'
+  };
+  
+  return categoryMap[key] || key;
+}
\ No newline at end of file
diff --git a/src/app/api/news/yahoo-detail/route.ts b/src/app/api/news/yahoo-detail/route.ts
new file mode 100644
index 0000000..6cc5bc3
--- /dev/null
+++ b/src/app/api/news/yahoo-detail/route.ts
@@ -0,0 +1,433 @@
+import { NextRequest, NextResponse } from 'next/server';
+import { JSDOM } from 'jsdom';
+
+async function getActualArticleUrl(pickupUrl: string): Promise<string> {
+  try {
+    const response = await fetch(pickupUrl, {
+      headers: {
+        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
+      }
+    });
+    
+    if (!response.ok) {
+      console.warn('pickup URLã®å–å¾—ã«å¤±æ•—ã€å…ƒURLã‚’ä½¿ç”¨');
+      return pickupUrl;
+    }
+    
+    const html = await response.text();
+    const dom = new JSDOM(html);
+    const document = dom.window.document;
+    
+    // å®Ÿéš›ã®è¨˜äº‹URLã‚’æ¢ã™
+    const articleLinkSelectors = [
+      'a[href*="news.yahoo.co.jp/articles/"]',
+      'a[href*="/articles/"]',
+      '.sc-cNKqjZ a',
+      '.article-link',
+      '[data-ual-module="Article"] a'
+    ];
+    
+    for (const selector of articleLinkSelectors) {
+      const linkElement = document.querySelector(selector);
+      if (linkElement) {
+        let href = linkElement.getAttribute('href');
+        if (href) {
+          if (href.startsWith('/')) {
+            href = `https://news.yahoo.co.jp${href}`;
+          }
+          if (href.includes('/articles/')) {
+            console.log(`âœ… å®Ÿéš›ã®è¨˜äº‹URLç™ºè¦‹: ${href}`);
+            return href;
+          }
+        }
+      }
+    }
+    
+    // è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆã‚’è©¦è¡Œ
+    const metaRefresh = document.querySelector('meta[http-equiv="refresh"]');
+    if (metaRefresh) {
+      const content = metaRefresh.getAttribute('content');
+      const urlMatch = content?.match(/url=(.+)/);
+      if (urlMatch) {
+        const redirectUrl = urlMatch[1];
+        if (redirectUrl.includes('/articles/')) {
+          console.log(`âœ… ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆURLç™ºè¦‹: ${redirectUrl}`);
+          return redirectUrl;
+        }
+      }
+    }
+    
+    console.warn('å®Ÿéš›ã®è¨˜äº‹URLãŒè¦‹ã¤ã‹ã‚‰ãªã„ã€å…ƒURLã‚’ä½¿ç”¨');
+    return pickupUrl;
+    
+  } catch (error) {
+    console.error('pickup URLè§£æã‚¨ãƒ©ãƒ¼:', error);
+    return pickupUrl;
+  }
+}
+
+export interface YahooArticleDetail {
+  title: string;
+  content: string;
+  publishedAt: string;
+  image?: string;
+  summary: string;
+  url: string;
+  source?: string;
+}
+
+async function scrapeYahooArticle(url: string): Promise<YahooArticleDetail> {
+  try {
+    console.log(`ğŸ”„ Yahoo!è¨˜äº‹ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°é–‹å§‹: ${url}`);
+    
+    let targetUrl = url;
+    
+    // pickup URLã®å ´åˆã€å®Ÿéš›ã®è¨˜äº‹URLã‚’å–å¾—
+    if (url.includes('/pickup/')) {
+      console.log('ğŸ” pickup URLã‚’æ¤œå‡ºã€å®Ÿéš›ã®è¨˜äº‹URLã‚’å–å¾—ä¸­...');
+      targetUrl = await getActualArticleUrl(url);
+      console.log(`ğŸ“° å®Ÿéš›ã®è¨˜äº‹URL: ${targetUrl}`);
+    }
+    
+    // ãƒ•ã‚§ãƒƒãƒ
+    const response = await fetch(targetUrl, {
+      headers: {
+        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
+      }
+    });
+    
+    if (!response.ok) {
+      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
+    }
+    
+    const html = await response.text();
+    const dom = new JSDOM(html);
+    const document = dom.window.document;
+    
+    // ãƒ‡ãƒãƒƒã‚°ï¼šãƒšãƒ¼ã‚¸ã®ä¸»è¦ãªæ§‹é€ ã‚’ç¢ºèª
+    console.log('ğŸ” Yahoo!ãƒšãƒ¼ã‚¸æ§‹é€ ãƒ‡ãƒãƒƒã‚°:');
+    const mainElements = [
+      'article',
+      '.article',
+      '[data-ual-module="Article"]',
+      '.sc-bxHsqm',
+      '.highLight',
+      'main'
+    ];
+    
+    mainElements.forEach(selector => {
+      const element = document.querySelector(selector);
+      if (element) {
+        console.log(`  âœ… ç™ºè¦‹: ${selector}`);
+      }
+    });
+    
+    // ã‚¿ã‚¤ãƒˆãƒ«å–å¾— - Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®æ§‹é€ ã«å¯¾å¿œ
+    const titleSelectors = [
+      'h1[data-ual-module="Headline"]',
+      '.sc-bxHsqm h1',
+      'article h1',
+      '.article-header h1',
+      'h1'
+    ];
+    
+    let title = '';
+    for (const selector of titleSelectors) {
+      const titleElement = document.querySelector(selector);
+      if (titleElement?.textContent?.trim()) {
+        title = titleElement.textContent.trim();
+        console.log(`âœ… ã‚¿ã‚¤ãƒˆãƒ«å–å¾—æˆåŠŸ: ${selector}`);
+        break;
+      }
+    }
+    
+    if (!title) {
+      title = document.title || 'ã‚¿ã‚¤ãƒˆãƒ«ä¸æ˜';
+    }
+    
+    // æœ¬æ–‡å–å¾— - Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®æ§‹é€ ã«å¯¾å¿œ
+    const contentSelectors = [
+      '.highLight p',                              // Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®è¨˜äº‹æœ¬æ–‡ï¼ˆæ—§æ§‹é€ ï¼‰
+      '[data-ual-module="Article"] p',             // ãƒ‡ãƒ¼ã‚¿å±æ€§ãƒ™ãƒ¼ã‚¹
+      '.sc-dmlJSK p',                             // æ–°ã—ã„ã‚¹ã‚¿ã‚¤ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
+      '.sc-bxHsqm .sc-eCBpNj p',                  // ã‚¹ã‚¿ã‚¤ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
+      '.article-body p',                           // ä¸€èˆ¬çš„ãªæ§‹é€ 
+      '.article-content p',
+      '.content p',
+      '.textBody p',
+      'article div p',                             // ã‚ˆã‚Šåºƒç¯„å›²
+      'main p'
+    ];
+    
+    let contentElements: NodeListOf<Element> | null = null;
+    let selectedSelector = '';
+    
+    for (const selector of contentSelectors) {
+      contentElements = document.querySelectorAll(selector);
+      if (contentElements.length > 0) {
+        selectedSelector = selector;
+        console.log(`âœ… ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å–å¾—æˆåŠŸ: ${selector} - ${contentElements.length}å€‹ã®æ®µè½`);
+        break;
+      }
+    }
+    
+    let content = '';
+    if (contentElements && contentElements.length > 0) {
+      const contentParts: string[] = [];
+      contentElements.forEach((element, index) => {
+        const text = element.textContent?.trim();
+        if (text && 
+            text.length > 15 &&                    // ã‚ˆã‚ŠçŸ­ã„æ–‡ã‚‚å«ã‚ã‚‹
+            !text.includes('ã‚·ã‚§ã‚¢') && 
+            !text.includes('ãƒ„ã‚¤ãƒ¼ãƒˆ') &&
+            !text.includes('é–¢é€£è¨˜äº‹') &&
+            !text.includes('ç¶šãã‚’èª­ã‚€') &&
+            !text.includes('Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹å€‹äºº') &&  // å›ºæœ‰åè©ã‚’é™¤ã
+            !text.includes('â€»ã“ã®è¨˜äº‹ã¯') &&
+            !text.includes('å†™çœŸ:') &&
+            !text.includes('ç”»åƒ:') &&
+            (text.includes('ã€‚') || text.includes('ã€') || text.length > 50) &&  // æ—¥æœ¬èªã®æ–‡ç« åˆ¤å®šã‚’ç·©å’Œ
+            !text.match(/^[a-zA-Z\s\.\(\)]+$/)) {  // è‹±èªã®ã¿ã‚’é™¤å¤–
+          contentParts.push(text);
+          if (index < 5) {
+            console.log(`ğŸ“ æ®µè½${index + 1}: ${text.substring(0, 50)}...`);
+          }
+        }
+      });
+      content = contentParts.join('\n\n');
+      console.log(`ğŸ“„ æœ€çµ‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é•·: ${content.length}æ–‡å­—, æ®µè½æ•°: ${contentParts.length}`);
+    }
+    
+    // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå–å¾—ã§ããªã„å ´åˆã®ä»£æ›¿å‡¦ç†
+    if (!content || content.length < 100) {
+      console.log('âš ï¸ Yahoo!è¨˜äº‹æœ¬æ–‡å–å¾—å¤±æ•—ã€ä»£æ›¿æ–¹æ³•ã‚’è©¦è¡Œ');
+      
+      // ã‚ˆã‚Šåºƒç¯„å›²ãªå–å¾—ã‚’è©¦è¡Œ
+      const allParagraphs = document.querySelectorAll('p');
+      const fallbackContent: string[] = [];
+      
+      allParagraphs.forEach(p => {
+        const text = p.textContent?.trim();
+        if (text && 
+            text.length > 30 &&
+            text.includes('ã€‚') &&
+            !text.includes('ã‚·ã‚§ã‚¢') &&
+            !text.includes('ãƒ„ã‚¤ãƒ¼ãƒˆ') &&
+            !text.includes('Yahoo!') &&
+            !text.includes('é…ä¿¡')) {
+          fallbackContent.push(text);
+        }
+      });
+      
+      content = fallbackContent.slice(0, 10).join('\n\n');
+      console.log(`ğŸ“„ ä»£æ›¿ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é•·: ${content.length}æ–‡å­—`);
+    }
+    
+    // ç”»åƒå–å¾— - è¨˜äº‹å†…å®¹ã«é–¢é€£ã™ã‚‹ç”»åƒã‚’å„ªå…ˆçš„ã«é¸æŠ
+    const imageSelectors = [
+      'article img',
+      '.article img', 
+      '.highLight img',
+      '[data-ual-module="Article"] img',
+      '.article-body img',
+      '.content img',
+      'main img'
+    ];
+    
+    let image = '';
+    let bestImage = '';
+    
+    // å…¨ã¦ã®ç”»åƒã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦æœ€é©ãªã‚‚ã®ã‚’é¸æŠ
+    for (const selector of imageSelectors) {
+      const imgElements = document.querySelectorAll(selector);
+      
+      for (const imgElement of imgElements) {
+        const src = imgElement.getAttribute('src');
+        if (!src) continue;
+        
+        let fullSrc = src;
+        if (!fullSrc.startsWith('http')) {
+          fullSrc = `https:${fullSrc}`;
+        }
+        
+        // åª’ä½“ãƒ­ã‚´ã‚„å°ã•ã„ç”»åƒã‚’é™¤å¤–
+        const alt = imgElement.getAttribute('alt') || '';
+        const width = imgElement.getAttribute('width') || imgElement.style.width || '';
+        const height = imgElement.getAttribute('height') || imgElement.style.height || '';
+        
+        // é™¤å¤–æ¡ä»¶ã‚’å¼·åŒ–
+        const isLogo = (
+          fullSrc.includes('logo') ||
+          fullSrc.includes('icon') ||
+          fullSrc.includes('favicon') ||
+          alt.toLowerCase().includes('logo') ||
+          alt.toLowerCase().includes('icon') ||
+          fullSrc.includes('avatar') ||
+          fullSrc.includes('profile') ||
+          // åª’ä½“åã‚’å«ã‚€ç”»åƒURLã‚’é™¤å¤–
+          fullSrc.includes('afp') ||
+          fullSrc.includes('sankei') ||
+          fullSrc.includes('asahi') ||
+          fullSrc.includes('mainichi') ||
+          fullSrc.includes('yomiuri') ||
+          fullSrc.includes('nikkei') ||
+          fullSrc.includes('kyodo') ||
+          fullSrc.includes('jiji') ||
+          fullSrc.includes('reuters') ||
+          fullSrc.includes('cnn') ||
+          fullSrc.includes('bloomberg') ||
+          // ãƒ•ã‚¡ã‚¤ãƒ«åãƒ‘ã‚¿ãƒ¼ãƒ³ã§é™¤å¤–
+          fullSrc.match(/\/(logo|icon|favicon|brand|corp|company|media)[\w\-]*\.(jpg|jpeg|png|gif|svg)/i) ||
+          // å›ºå®šã‚µã‚¤ã‚ºã®å°ã•ã„ç”»åƒï¼ˆå¤§æŠµãƒ­ã‚´ï¼‰
+          fullSrc.includes('150x') ||
+          fullSrc.includes('200x') ||
+          fullSrc.includes('100x') ||
+          fullSrc.includes('50x')
+        );
+        
+        const isSmall = (
+          (width && parseInt(width) < 150) ||
+          (height && parseInt(height) < 150)
+        );
+        
+        // åºƒå‘Šã‚„SNSé–¢é€£ã®ç”»åƒã‚’é™¤å¤–
+        const isAd = (
+          fullSrc.includes('ad') ||
+          fullSrc.includes('banner') ||
+          fullSrc.includes('promo') ||
+          fullSrc.includes('sns') ||
+          fullSrc.includes('social') ||
+          fullSrc.includes('twitter') ||
+          fullSrc.includes('facebook') ||
+          fullSrc.includes('youtube') ||
+          fullSrc.includes('instagram') ||
+          fullSrc.includes('tiktok')
+        );
+        
+        // Yahoo!å›ºæœ‰ã®é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³
+        const isYahooSystem = (
+          fullSrc.includes('y.yimg.jp') && (
+            fullSrc.includes('/default/') ||
+            fullSrc.includes('/common/') ||
+            fullSrc.includes('/ui/') ||
+            fullSrc.includes('/logo/') ||
+            fullSrc.includes('/icon/')
+          )
+        );
+        
+        if (!isLogo && !isSmall && !isAd && !isYahooSystem) {
+          // æœ€åˆã«è¦‹ã¤ã‹ã£ãŸé©åˆ‡ãªç”»åƒã‚’ä½¿ç”¨
+          if (!bestImage) {
+            bestImage = fullSrc;
+            console.log(`âœ… è¨˜äº‹ç”»åƒã‚’é¸æŠ: ${fullSrc.substring(0, 80)}...`);
+            break;
+          }
+        } else {
+          const reason = isLogo ? 'ãƒ­ã‚´/åª’ä½“' : isSmall ? 'å°ã•ã™ãã‚‹' : isAd ? 'ã‚½ãƒ¼ã‚·ãƒ£ãƒ«/åºƒå‘Š' : 'Yahooã‚·ã‚¹ãƒ†ãƒ ';
+          console.log(`âš ï¸ ç”»åƒã‚’ã‚¹ã‚­ãƒƒãƒ—: ${fullSrc.substring(0, 50)}... (ç†ç”±: ${reason})`);
+        }
+      }
+      
+      if (bestImage) break;
+    }
+    
+    image = bestImage;
+    
+    // å…¬é–‹æ—¥æ™‚å–å¾—
+    const timeSelectors = [
+      'time',
+      '[data-ual-module="Time"]',
+      '.article-time',
+      '.sc-time'
+    ];
+    
+    let publishedAt = new Date().toISOString();
+    for (const selector of timeSelectors) {
+      const timeElement = document.querySelector(selector);
+      if (timeElement) {
+        const datetime = timeElement.getAttribute('datetime') || timeElement.textContent?.trim();
+        if (datetime) {
+          publishedAt = datetime;
+          break;
+        }
+      }
+    }
+    
+    // é…ä¿¡å…ƒå–å¾—
+    const sourceElement = document.querySelector('[data-ual-module="Source"]') ||
+                         document.querySelector('.source') ||
+                         document.querySelector('.article-source');
+    const source = sourceElement?.textContent?.trim() || 'Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹';
+    
+    // è¦ç´„ä½œæˆ
+    const summary = content.length > 100 
+      ? content.substring(0, 100) + '...'
+      : content;
+    
+    const result: YahooArticleDetail = {
+      title,
+      content: content || 'è¨˜äº‹å†…å®¹ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚',
+      publishedAt,
+      image: image || undefined,
+      summary,
+      url,
+      source
+    };
+    
+    console.log(`âœ… Yahoo!è¨˜äº‹ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°å®Œäº†:`, {
+      title: title.substring(0, 30) + '...',
+      contentLength: content.length,
+      hasImage: !!image,
+      source
+    });
+    
+    return result;
+    
+  } catch (error) {
+    console.error(`âŒ Yahoo!è¨˜äº‹ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚¨ãƒ©ãƒ¼: ${url}`, error);
+    throw error;
+  }
+}
+
+export async function GET(request: NextRequest) {
+  try {
+    const { searchParams } = new URL(request.url);
+    const url = searchParams.get('url');
+    
+    if (!url) {
+      return NextResponse.json({
+        success: false,
+        error: 'URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå¿…è¦ã§ã™'
+      }, { status: 400 });
+    }
+    
+    // Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®URLã‹ãƒã‚§ãƒƒã‚¯
+    if (!url.includes('news.yahoo.co.jp')) {
+      return NextResponse.json({
+        success: false,
+        error: 'Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®è¨˜äº‹URLã®ã¿ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™'
+      }, { status: 400 });
+    }
+    
+    console.log(`ğŸ”„ Yahoo!è¨˜äº‹è©³ç´°å–å¾—é–‹å§‹: ${url}`);
+    
+    const articleDetail = await scrapeYahooArticle(url);
+    
+    console.log(`âœ… Yahoo!è¨˜äº‹è©³ç´°å–å¾—å®Œäº†`);
+    
+    return NextResponse.json({
+      success: true,
+      article: articleDetail,
+      fetchedAt: new Date().toISOString()
+    });
+    
+  } catch (error) {
+    console.error('Yahoo!è¨˜äº‹è©³ç´°å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
+    
+    return NextResponse.json({
+      success: false,
+      error: 'Yahoo!è¨˜äº‹ã®è©³ç´°å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ',
+      details: error instanceof Error ? error.message : 'Unknown error'
+    }, { status: 500 });
+  }
+}
\ No newline at end of file
diff --git a/src/lib/database/memory.ts b/src/lib/database/memory.ts
index 83e2b8c..eb8dd6c 100644
--- a/src/lib/database/memory.ts
+++ b/src/lib/database/memory.ts
@@ -7,17 +7,56 @@ import {
   DatabaseError 
 } from './types';
 
+// ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
+const globalForDb = globalThis as unknown as {
+  memoryProviderData: {
+    articles: Map<number, Article>;
+    users: Map<string, User>;
+    reactions: Map<string, ArticleReaction>;
+    questions: Map<string, Question>;
+    nextArticleId: number;
+    nextQuestionId: number;
+    initialized: boolean;
+  } | undefined;
+};
+
 // æ—¢å­˜ã®article-store.tsã®æ©Ÿèƒ½ã‚’DatabaseProviderã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«æº–æ‹ ã•ã›ã‚‹
 export class MemoryProvider implements DatabaseProvider {
-  private articles: Map<number, Article> = new Map();
-  private users: Map<string, User> = new Map();
-  private reactions: Map<string, ArticleReaction> = new Map();
-  private questions: Map<string, Question> = new Map();
-  private nextArticleId = 1000; // åˆæœŸã‚µãƒ³ãƒ—ãƒ«è¨˜äº‹ã¨é‡è¤‡ã‚’é¿ã‘ã‚‹ãŸã‚1000ã‹ã‚‰é–‹å§‹
-  private nextQuestionId = 1;
+  private articles: Map<number, Article>;
+  private users: Map<string, User>;
+  private reactions: Map<string, ArticleReaction>;
+  private questions: Map<string, Question>;
+  private nextArticleId: number;
+  private nextQuestionId: number;
 
   constructor() {
-    this.initializeData();
+    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„å ´åˆã®ã¿åˆæœŸåŒ–
+    if (!globalForDb.memoryProviderData) {
+      globalForDb.memoryProviderData = {
+        articles: new Map(),
+        users: new Map(),
+        reactions: new Map(),
+        questions: new Map(),
+        nextArticleId: 1000,
+        nextQuestionId: 1,
+        initialized: false
+      };
+    }
+
+    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§
+    const data = globalForDb.memoryProviderData;
+    this.articles = data.articles;
+    this.users = data.users;
+    this.reactions = data.reactions;
+    this.questions = data.questions;
+    this.nextArticleId = data.nextArticleId;
+    this.nextQuestionId = data.nextQuestionId;
+
+    // åˆæœŸåŒ–ãŒå¿…è¦ãªå ´åˆã®ã¿å®Ÿè¡Œ
+    if (!data.initialized) {
+      this.initializeData();
+      data.initialized = true;
+    }
   }
 
   private initializeData() {
@@ -77,10 +116,15 @@ export class MemoryProvider implements DatabaseProvider {
       this.articles.set(article.id, article);
       if (article.id >= this.nextArticleId) {
         this.nextArticleId = article.id + 1;
+        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‡ãƒ¼ã‚¿ã«ã‚‚åæ˜ 
+        if (globalForDb.memoryProviderData) {
+          globalForDb.memoryProviderData.nextArticleId = this.nextArticleId;
+        }
       }
     });
 
     console.log(`ğŸ”§ MemoryProvideråˆæœŸåŒ–å®Œäº†: ${this.articles.size}ä»¶ã®è¨˜äº‹ã‚’è¨­å®š`);
+    console.log(`ğŸ“‹ è¨˜äº‹ä¸€è¦§:`, Array.from(this.articles.keys()));
   }
 
   async testConnection(): Promise<boolean> {
@@ -94,6 +138,8 @@ export class MemoryProvider implements DatabaseProvider {
     isArchived?: boolean;
     limit?: number;
   }): Promise<Article[]> {
+    console.log(`ğŸ” getArticleså‘¼ã³å‡ºã—: ${this.articles.size}ä»¶ã®è¨˜äº‹ãŒå­˜åœ¨`);
+    console.log(`ğŸ“‹ ç¾åœ¨ã®è¨˜äº‹ID:`, Array.from(this.articles.keys()));
     let articles = Array.from(this.articles.values());
 
     // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
@@ -121,14 +167,39 @@ export class MemoryProvider implements DatabaseProvider {
   }
 
   async createArticle(article: Omit<Article, 'id' | 'createdAt'>): Promise<Article> {
+    console.log(`ğŸ”¥ createArticleå‘¼ã³å‡ºã—é–‹å§‹`);
+    console.log(`ğŸ”¥ å…¥åŠ›è¨˜äº‹:`, { 
+      title: article.convertedTitle?.substring(0, 50),
+      category: article.category 
+    });
+    console.log(`ğŸ”¥ ç¾åœ¨ã®è¨˜äº‹æ•°: ${this.articles.size}ä»¶`);
+    console.log(`ğŸ”¥ æ¬¡ã®ID: ${this.nextArticleId}`);
+    
     const newArticle: Article = {
       ...article,
-      id: this.nextArticleId++,
+      id: this.nextArticleId,
       createdAt: new Date().toISOString()
     };
 
+    // IDã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã—ã¦ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‡ãƒ¼ã‚¿ã«ã‚‚åæ˜ 
+    this.nextArticleId++;
+    if (globalForDb.memoryProviderData) {
+      globalForDb.memoryProviderData.nextArticleId = this.nextArticleId;
+      console.log(`ğŸ”¥ ã‚°ãƒ­ãƒ¼ãƒãƒ«nextArticleIdã‚’æ›´æ–°: ${this.nextArticleId}`);
+    } else {
+      console.error(`ğŸš¨ ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ã¾ã›ã‚“ï¼`);
+    }
+
     this.articles.set(newArticle.id, newArticle);
-    console.log(`ğŸ“š è¨˜äº‹ã‚’ä¿å­˜ã—ã¾ã—ãŸ: ID=${newArticle.id}, ã‚¿ã‚¤ãƒˆãƒ«=${newArticle.convertedTitle.substring(0, 30)}...`);
+    console.log(`ğŸ”¥ è¨˜äº‹ã‚’ä¿å­˜å®Œäº†: ID=${newArticle.id}, ã‚¿ã‚¤ãƒˆãƒ«=${newArticle.convertedTitle.substring(0, 30)}...`);
+    console.log(`ğŸ”¥ ä¿å­˜å¾Œã®è¨˜äº‹æ•°: ${this.articles.size}ä»¶`);
+    console.log(`ğŸ”¥ ä¿å­˜å¾Œã®IDä¸€è¦§:`, Array.from(this.articles.keys()));
+    
+    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
+    if (globalForDb.memoryProviderData) {
+      console.log(`ğŸ”¥ ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨˜äº‹æ•°: ${globalForDb.memoryProviderData.articles.size}ä»¶`);
+    }
+    
     return newArticle;
   }
 
diff --git a/src/lib/database/supabase.ts b/src/lib/database/supabase.ts
index 1cfae92..2610581 100644
--- a/src/lib/database/supabase.ts
+++ b/src/lib/database/supabase.ts
@@ -204,6 +204,21 @@ export class SupabaseProvider implements DatabaseProvider {
   // ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ“ä½œ
   async addReaction(articleId: number, userId: string, reaction: string): Promise<boolean> {
     try {
+      // ã¾ãšæ—¢å­˜ã®ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯
+      const { data: existingReaction } = await this.client
+        .from('article_reactions')
+        .select('*')
+        .eq('article_id', articleId)
+        .eq('user_id', userId)
+        .eq('reaction', reaction)
+        .single();
+
+      // æ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯æˆåŠŸã¨ã—ã¦è¿”ã™
+      if (existingReaction) {
+        return true;
+      }
+
+      // å­˜åœ¨ã—ãªã„å ´åˆã¯æ–°è¦è¿½åŠ 
       const { error } = await this.client
         .from('article_reactions')
         .insert([{
@@ -214,6 +229,10 @@ export class SupabaseProvider implements DatabaseProvider {
         }]);
 
       if (error) {
+        // é‡è¤‡ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯æˆåŠŸã¨ã—ã¦æ‰±ã†
+        if (error.code === '23505') {
+          return true;
+        }
         throw new DatabaseError(`ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ ã‚¨ãƒ©ãƒ¼: ${error.message}`, error.code);
       }
 
-- 
2.42.0

